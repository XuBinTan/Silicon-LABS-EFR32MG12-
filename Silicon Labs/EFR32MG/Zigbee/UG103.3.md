# UG103.3: Application Development Fundamentals: Design Choices
>    应用程序开发基础：设计选择

``` 
本文档根据如何构建无线网络解决方案必须做出的重大决策来描述应用程序设计过程。
```  

硅实验室的应用程序开发基础系列涵盖了项目经理、应用程序设计人员和开发人员在开始 使用硅实验室芯片、诸如EmberZNetpro或硅实验室蓝牙智能的网络栈和相关开发工具开发 嵌入式网络解决方案之前应该了解的主题。对于任何需要介绍开发无线网络应用程序的人 ，或者是对硅实验室开发环境来说 ，这些文档都是一个起点。  


**要点**  
* 要使用哪个堆栈或应用程序框架？  
*  SoC or NCP?  
*  Zigbee design choices  


## **1. 背景(Background)**  
当我们进入一个家中的设备都相互连接的世界时，Silicon　Labs正在正在开发满足客户需
求的产品。这通常被称之为物联网。在高层次上，物联网对硅实验室的目标是： 

* 将家中的所有设备与一流的网络连接起来，无论是使用zigbeeepro、线程、蓝牙智能还
是其他新兴标准。 
* 利用公司在能源友好型微控制器方面的专长。 
* 增强已建立的低功耗混合信号芯片。
* 启用云服务和与智能手机和平板电脑的连接，从而提高用户的易用性和共同的用户体验。 

实现所有这些目标将提高接入家庭的物联网设备的使用率和用户接受率。随着应用程序
设计器可用选项范围的增加，早期设计选择的影响也会增加。本文档描述了应用程序设
计过程中必须做出的关于如何构建无线网络工作解决方案的重大决策。

基本设计选择包括：

* 使用哪种硅实验室无线技术 
* 是采用soc(片上系统)设计还是ncp(网络协处理器)设计。
* 如果使用ncp模型，如何选择兼容的ncp和主机应用程序。

开发ZigBee解决方案时的设计选择包括： 

* 如何创建网络(form, join, or leave)
* 将使用什么样的安全模型
* 在网络中使用什么样的路由优化
* 如何通过网络传递消息  

一旦考虑了这些选择，就可以开始实现系统设计了。  

## **1. 一般设计选择(General Design Choices)**  

在开始使用硅实验室的无线微控制器进行无线设计之前，您应该首先考虑哪些可用的网络
技术最适合您的项目。一旦您决定了要用于您的设计的网络协议，请考虑您的产品是最适
合于片上系统（Soc）范式还是网络协处理器（Ncp）模式，对于ncp来说，要使用何种串行

通信来控制协处理器。

###**2.1 您应该使用哪种无线协议？**
Silicon Labs 在the Wireless Gecko family的开发提供了以下的堆栈： 

* Silicon　Labs　Flex　SDK包括：基于IEEE802.15.4的“连接”堆栈用于多跳“星型”网络
拓扑，以及用于具有自定义RF配置的真正专有设计的无线电抽象接口库(Rails)。
* EmberZNet，一个基于ZigBee　Pro的网格网络栈，在ug103.2中详细描述了：应用
程序开发基础：ZigBee。
* 硅实验室线程，一个基于1.1线程的IPv6　Mesh网络栈，在ug103.11中详细描述了：
应用程序开发基本原理：线程。
* 硅实验室蓝牙SDK，一种基于蓝牙2.3的网络栈，在ug103.14中详细描述了：应用程
序开发基础：蓝牙智能技术。

在熟悉了这些协议的细节之后，您可能会根据您对标准遵从性、网络拓扑、互操作性、
频率范围和消息吞吐量的需求来选择这些协议。

###**2.2 SoC or NCP?**  
无论您是否使用应用程序框架进行设计，设计范式─的选择，无论是soc(sys-tem-on-Chip)
模型还是ncp（串行网络协处理器）模型─都是至关重要的。它决定了软件和硬件的要求和
约束。此选择控制应用程序相对于核心堆栈功能驻留的位置。在SoC模型中，整个系统（堆
栈和应用程序）驻留在单个芯片上，而在NCP模型中，堆栈处理是在一个单独的“协处理器”
中完成的，它通过外部串行接口与应用程序自己的微控制器交互。 

下图说明了堆栈和应用程序的各种组件，以及它们是如何相对于SoC或NCP体系结构模型进行组织的。

![](https://github.com/XuBinTan/Silicon-LABS-EFR32MG12-/blob/master/Silicon%20Labs/EFR32MG/photo/Slicon%20UG103.3%20F2.1.jpg)

虽然在体系结构之间进行选择是不容易的，但应用程序框架在某种程度上掩盖了差异，在必要时简化了从一个体系结构到另一个体系结构的更改，或者支持不同产品的混合体系结构。

###**2.3 系统片上方法**  
在SoC方法中，一个单一的芯片，例如无线壁虎(efr 32™)组合中的ICS之一，提供所有堆栈功能(包括集成的flash、ram和rf收发器)以及应用层组件(应用程序配置文件、集群、协议管理和堆栈交互)。堆栈功能实现为预编译库文件，然后，您必须在最后的构建过程中与您自己的应用程序相关代码一起链接，以生成一个单一的、单块二进制映像，该映像包含了一个功能齐全的无线应用程序所需的一切。应用程序框架，虽然是由硅实验室提供的，但被认为是应用层的一部分。

注意：虽然引导加载程序通常用于已部署的无线网络设备，但引导加载程序固件并不是这个单芯片二进制映像的一部分。然而，Silicon Labs 提供可用于将应用程序固件和堆栈固件进一步组合为单个十六进制记录文件的后期构建工具，以便于分发和制造。有关EmberZNet pro应用程序的这些软件实用程序的更多信息，请参阅文档ug 107：em3x实用程序指南、ug 162：简单指挥官参考指南和文档ug 103.6：应用程序开发基础：引导。在soc开发方法中，应用程序(包括应用程序框架)与堆栈共存。应用程序调用由堆栈库提供的API(应用程序编程接口函数)，堆栈触发器处理函数由应用程序代码嵌入。当应用程序框架用于应用程序设计时，该框架处理调用这些API并实现必要的处理程序函数，然后将这些函数封装在更高级别的API和应用程序回调中，以实现设计过程，并帮助确保协议遵从性。

由于SoC模型只需要一个芯片，与需要多个ICS的NCP模型和遗留设计体系结构相比，SoC模型具有更低的功耗、更低的BOM(物料清单)成本和更小的可能布局。此外，当所有东西都驻留在单个芯片上时，可以与堆栈软件和无线电硬件进行更紧密的集成，从而能够更精确和及时地控制与堆栈活动相关的应用程序行为。

但是，一旦您应用了SoC模型，您就会受到SoC家族中可用产品的约束。这些措施包括：

* 闪存和内存约束
* 工具链约束，例如ZigBee和基于线程的soc使用iar嵌入式工作台的要求。
* Hal约束，例如某种类型的有限数量的外围设备，或者缺少可能是硬件设计不可或缺的专用外围设备。
* 基于必须与堆栈共享CPU的定时约束，堆栈有自己的一组需求，以维护IEEE802.15.4和协议遵从性

   ** 如果这些限制中的任何一个都具有威慑作用，那么NCP模式可能是一个更有吸引力的替代方案。**

###**2.3 采用串行协议的NCP方法**  

 
